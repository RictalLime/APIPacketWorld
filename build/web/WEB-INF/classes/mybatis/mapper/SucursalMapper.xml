<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sucursal" >
    
    <select id="obtenerSucursales" resultType="pojo.Sucursal">
        SELECT 
            s.idSucursal,
            s.codigoSucursal,
            s.nombre AS nombreSucursal,
            s.estatus,
            s.calle,
            s.numero,
            s.colonia,
            s.codigoPostal,
            c.idCiudad,
            c.nombre AS ciudad,
            e.idEstado,
            e.nombre AS estado
        FROM sucursal s
        INNER JOIN ciudad c ON c.idCiudad = s.idCiudad
        INNER JOIN estado e ON e.idEstado = s.idEstado;
    </select>

    
    <insert id="registrar" parameterType="pojo.Sucursal">
        INSERT INTO sucursal 
        (codigoSucursal, nombre, estatus, calle, numero, colonia, codigoPostal, idCiudad, idEstado)
        VALUES 
        (#{codigoSucursal}, #{nombre}, #{estatus}, #{calle}, #{numero}, #{colonia}, #{codigoPostal}, #{idCiudad}, #{idEstado});
    </insert>
    
    <update id="editar" parameterType="pojo.Sucursal">
        UPDATE sucursal
        SET nombre = #{nombre},
            calle = #{calle},
            numero = #{numero},
            colonia = #{colonia},
            codigoPostal = #{codigoPostal},
            idCiudad = #{idCiudad},
            idEstado = #{idEstado}
        WHERE idSucursal = #{idSucursal};
    </update>
    
    <select id="obtenerSucursalPorId" resultType="pojo.Sucursal">
        SELECT 
            s.idSucursal,
            s.codigoSucursal,
            s.nombre,
            s.estatus,
            s.calle,
            s.numero,
            s.colonia,
            s.codigoPostal,
            s.idCiudad,
            s.idEstado
        FROM sucursal s
        WHERE s.idSucursal = #{idSucursal};
    </select>
    
    <update id="actualizarEstatus" parameterType="pojo.Sucursal">
        UPDATE sucursal
        SET estatus = #{estatus}
        WHERE idSucursal = #{idSucursal};
    </update>
    
</mapper>